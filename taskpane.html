<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>My Taskpane</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <!-- Put a button on the task pane -->
    <p>Hit the Run button 12:37!</p>
    <button id="run-btn" type="button">Run</button>
    <script>
        // Initialize Office.js
        Office.onReady(function (info) { });

        // Add a click event listener to the button
        document.getElementById("run-btn").addEventListener("click", runa);

        // Based on 'Basic API call' sample from ScriptLab
        async function runa() {
            await Excel.run(async (context) => {
                const range = context.workbook.getSelectedRange();
                range.format.fill.color = "yellow";
                range.load("address");

                await context.sync();

                const sheets = context.workbook.worksheets;
                sheets.getItem("Sheet1").getRange("A1").values = [["The selected address was " + range.address + "."]];
            });
        }

    </script>
      <p>Hit the Run button TTTEESST!</p>
    <button id="run-btna" type="button">WS</button>
    <script>
       Office.onReady(function (info) { });
       document.getElementById("run-btna").addEventListener("click", run);
    async function run() {
        sheets.getItem("Sheet1").getRange("B6").values ='';
      // Create a new XMLHttpRequest object
      var xhr = new XMLHttpRequest();
    sheets.getItem("Sheet1").getRange("B1").values ='in the method';
      // Define the API endpoint URL
      var apiUrl = 'https://9ea7-34-83-39-85.ngrok-free.app';
        sheets.getItem("Sheet1").getRange("B2").values ='before call';
    fetch(apiUrl)
        .then(function(response) {
          if (response.ok) {
            return response.json();
          } else {
              sheets.getItem("Sheet1").getRange("B3").values =response;
            throw new Error('Error: ' + response.status);
          }
        })
        .then(function(data) {
          console.log(data);
          // Process the response data
        })
        .catch(function(error) {
          console.log(error);
            sheets.getItem("Sheet1").getRange("B4").values =error;
          // Handle the error
        });
}

    </script>
</body>

</html>
