<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Task Pane</title>
  <!-- Load office.js and xlwings.min.js -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <!-- Bootstrap with the xlwings theme -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/xlwings/bootstrap-xlwings@5.2.3-2/dist/bootstrap-xlwings.min.css"
    integrity="sha384-TZ8CaOSXLBEEL73Aw1vX6a/2YP7QHdiuilF2C8Put8X81F3FzyRgt9ba77CMKAXq" crossorigin="anonymous">
  <!-- Load Custom Functions -->
</head>

<body>
    <!-- Put a button on the task pane -->
    <p>Hit the Run button 10:38!</p>
    <button id="run-btn" type="button">Run</button>
    <p>Hit the Run button TTTEESST!</p>
    <button id="run-btna" type="button">WS</button>
    
    <script>
        // Initialize Office.js
        Office.onReady(function (info) { });

        // Add a click event listener to the button
        document.getElementById("run-btn").addEventListener("click", run);
         document.getElementById("run-btna").addEventListener("click", fetchData);
        // Based on 'Basic API call' sample from ScriptLab
        async function run() {
            await Excel.run(async (context) => {
                const range = context.workbook.getSelectedRange();
                range.format.fill.color = "yellow";
                range.load("address");

                await context.sync();

                const sheets = context.workbook.worksheets;
                sheets.getItem("Sheet1").getRange("A1").values = [["The selected address was " + range.address + "."]];
            });
        }
      function fetchData() {
            fetch('https://api.publicapis.org/entries')
                .then(response => response.json())
                .then(data => {
                    // Handle the API response data
                    console.log(data);
                    // Update the HTML content with the received data
                    document.getElementById('result').textContent = JSON.stringify(data, null, 2);
                })
                .catch(error => {
                    // Handle any errors that occur during the API request
                    console.error('Error:', error);
                });
        }

       

    </script>

     

</body>

</html>
